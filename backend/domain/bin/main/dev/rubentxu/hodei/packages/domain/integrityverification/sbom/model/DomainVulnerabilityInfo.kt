package dev.rubentxu.hodei.packages.domain.model.sbom

import dev.rubentxu.hodei.packages.domain.common.model.VexStatus
import java.time.Instant

/**
 * Detailed information about a specific vulnerability.
 *
 * @param cveId The Common Vulnerabilities and Exposures (CVE) identifier.
 * @param description A human-readable description of the vulnerability.
 * @param status The VEX (Vulnerability Exploitability eXchange) status of this vulnerability
 *               in the context of the analyzed component/product.
 * @param severity The assessed severity of the vulnerability.
 * @param cvssV3Score The CVSS v3.x base score.
 * @param cvssV3Vector The CVSS v3.x vector string.
 * @param cwes List of Common Weakness Enumeration (CWE) identifiers associated with this vulnerability.
 * @param source The source from which this vulnerability information was obtained (e.g., NVD, OSV, GitHub).
 * @param publishedDate The date when the vulnerability was first published.
 * @param lastModifiedDate The date when the vulnerability information was last modified.
 * @param recommendation Suggested actions to mitigate or fix the vulnerability.
 * @param references A list of external references for more information (advisories, articles, etc.).
 * @param affectedPackageName The name of the specific package or library that is vulnerable.
 * @param affectedVersionRange The range of versions of the package that are affected.
 */
data class DomainVulnerabilityInfo(
    val cveId: String,
    val description: String,
    val status: VexStatus, // Changed from String to VexStatus
    val severity: VulnerabilitySeverity? = null,
    val cvssV3Score: Double? = null,
    val cvssV3Vector: String? = null,
    val cwes: List<String>? = null,
    val source: String? = null,
    val publishedDate: Instant? = null,
    val lastModifiedDate: Instant? = null,
    val recommendation: String? = null,
    val references: List<VulnerabilityReference>? = null,
    val affectedPackageName: String? = null,
    val affectedVersionRange: String? = null
)

/**
 * Represents the severity of a vulnerability.
 */
enum class VulnerabilitySeverity {
    CRITICAL,
    HIGH,
    MEDIUM,
    LOW,
    INFORMATIONAL,
    UNKNOWN
}


/**
 * Represents an external reference for a vulnerability.
 *
 * @param type The type of reference (e.g., "ADVISORY", "FIX", "REPORT", "ARTICLE").
 * @param url The URL of the reference.
 * @param description An optional description of the reference.
 */
data class VulnerabilityReference(
    val type: String,
    val url: String,
    val description: String? = null
)